<!DOCTYPE html>
<html lang="zh-cn" >
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  
  <meta name="author"
        content="alonWang"/>

  
  <meta name="description" content="220. 存在重复元素 II 给定一个整数数组，判断数组中是否有两个不同的索引 i 和 j，使得 nums [i] 和 nums [j] 的差的绝对值最大为 t，并且 i 和 j 之间的差的绝对值最大为 ķ。 示例 1: 输入: nums = [1,2,3,1], k = 3, t = 0 输出: true 示例 2: 输入: nums = [1,0,1,1],"/>
  

  
  
  <meta name="keywords" content="Java, Life, Love"/>
  

  
  <link rel="canonical" href="https://alonwang.github.io/blog/posts/leetcode-220/"/>

  

  <title>Leetcode 220 &middot; 卫龙哥哥的小站</title>

  <link rel="shortcut icon" href="https://alonwang.github.io/blog/images/favicon.ico"/>
  <link rel="stylesheet" href="https://alonwang.github.io/blog/css/animate.min.css"/>
  <link rel="stylesheet" href="https://alonwang.github.io/blog/css/remixicon.css"/>
  <link rel="stylesheet" href="https://alonwang.github.io/blog/css/zozo.css"/>
  <link rel="stylesheet" href="https://alonwang.github.io/blog/css/highlight.css"/>

  
  
</head>

<body>
<div class="main animated">
  <div class="nav_container animated fadeInDown">
  <div class="site_nav" id="site_nav">
    <ul>
      
      <li>
        <a href="/blog/">首页</a>
      </li>
      
      <li>
        <a href="/blog/posts/">归档</a>
      </li>
      
      <li>
        <a href="/blog/tags/">标签</a>
      </li>
      
      <li>
        <a href="/blog/about/">关于</a>
      </li>
      
    </ul>
  </div>
  <div class="menu_icon">
    <a id="menu_icon"><i class="remixicon-links-line"></i></a>
  </div>
</div>

  <div class="header animated fadeInDown">
  <div class="site_title_container">
    <div class="site_title">
      <h1>
        <a href="https://alonwang.github.io/blog">
          <span>卫龙哥哥的小站</span>
          <img src="https://alonwang.github.io/blog/images/logo.svg"/>
        </a>
      </h1>
    </div>
    <div class="description">
      <p class="sub_title">Tech &amp; Thought</p>
      <div class="my_socials">
        
        
        <a href="%20" title="facebook" target="_blank"><i class="remixicon-facebook-fill"></i></a>
        
        
        
        <a href="https://github.com/alonWang" title="github" target="_blank"><i class="remixicon-github-fill"></i></a>
        
        
        
        <a href="%20" title="instagram" target="_blank"><i class="remixicon-instagram-fill"></i></a>
        
        
        
        <a href="%20" title="twitter" target="_blank"><i class="remixicon-twitter-fill"></i></a>
        
        
        
        <a href="%20" title="weibo" target="_blank"><i class="remixicon-weibo-fill"></i></a>
        
        
        <a href="https://alonwang.github.io/blog/index.xml" type="application/rss+xml" title="rss" target="_blank"><i class="remixicon-rss-fill"></i></a>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post_page">
      <div class="post animated fadeInDown">
        <div class="post_title post_detail_title">
          <h2><a href='/blog/posts/leetcode-220/'>Leetcode 220</a></h2>
          <span class="date">2019.09.09</span>
        </div>
        <div class="post_content markdown">

<h3 id="220-存在重复元素-ii">220. 存在重复元素 II</h3>

<blockquote>
<p>给定一个整数数组，判断数组中是否有两个不同的索引 i 和 j，使得 nums [i] 和 nums [j] 的差的绝对值最大为 t，并且 i 和 j 之间的差的绝对值最大为 ķ。</p>

<p>示例 1:</p>

<p>输入: nums = [1,2,3,1], k = 3, t = 0
输出: true
示例 2:</p>

<p>输入: nums = [1,0,1,1], k = 1, t = 2
输出: true
示例 3:</p>

<p>输入: nums = [1,5,9,1,5,9], k = 2, t = 3
输出: false</p>

<p>来源：力扣（LeetCode）
链接：<a href="https://leetcode-cn.com/problems/contains-duplicate-iii">https://leetcode-cn.com/problems/contains-duplicate-iii</a>
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>

<p>很惭愧,五月份做过这道题,九月份再看完全没有印象,看了官方题解才想起来思路,有必要记录下~毕竟事不过三.</p>

<h3 id="问题的实质">问题的实质</h3>

<blockquote>
<p>使得 nums [i] 和 nums [j] 的差的绝对值最大为 t</p>
</blockquote>

<p>数组中存在两个临近数字,间隔小于等于t.</p>

<blockquote>
<p>并且 i 和 j 之间的差的绝对值最大为 ķ</p>
</blockquote>

<p>要维持原数组的下标</p>

<p>上面两句就是这道题的实质,这道题分类是排序,那么先用各种排序思想的关键字套一下:</p>

<ul>
<li>快排: 基准点,划分,部分有序,位置</li>
<li>堆排序: top K</li>
<li>桶排序: 映射,查找,原始数据无影响</li>
</ul>

<p><strong>查找</strong>,<strong>原始数据无影响</strong>  就是它了! 桶排序</p>

<h3 id="要点解析">要点解析</h3>

<pre><code class="language-java">/**
 * 基于桶排序 从当前桶或相邻的桶中寻找,并且只维护当前k个数字
 */
public class Q220 {
    private long getID(long i, long w) {
        //1. 
        return i &lt; 0 ? (i + 1) / w - 1 : i / w;
    }

    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) {
        if (t &lt; 0) return false;
        Map&lt;Long, Long&gt; d = new HashMap&lt;&gt;();
        long w = (long) t + 1;
        for (int i = 0; i &lt; nums.length; ++i) {
            long m = getID(nums[i], w);
            //2.  
            if (d.containsKey(m))
                return true;
            if (d.containsKey(m - 1) &amp;&amp; Math.abs(nums[i] - d.get(m - 1)) &lt; w)
                return true;
            if (d.containsKey(m + 1) &amp;&amp; Math.abs(nums[i] - d.get(m + 1)) &lt; w)
                return true;
            d.put(m, (long) nums[i]);
           //3. 
            if (i &gt;= k) d.remove(getID(nums[i - k], w));
        }
        return false;
    }
}

</code></pre>

<h4 id="1-划分桶-确定hash方式">1. 划分桶 ==&gt; 确定hash方式</h4>

<p>如果只考虑正数,我们需要以t为间隔划分桶 ==&gt; [nt,(n+1)t]划分为一个桶,一个桶对应一个唯一的id,表示为:</p>

<pre><code>id=num/(t+1)
</code></pre>

<p>如果是负数,我们需要以t为间隔划分桶 ==&gt; [-n(t+1),-(n-1)(t+1)-1]划分为一个桶.</p>

<p>举个例子,假设t=4,那么[-5,-1] 对应 -1这个id.  基于语言的取整特性</p>

<pre><code class="language-java">-4~-1 / 5 =0
</code></pre>

<p>而我们需要的是-1, 因此 针对负数 需要额外 -1 修正.</p>

<p>同时由于</p>

<pre><code>-5 / 5 = -1
</code></pre>

<p>这样经过上面的修正就导致 -5/5 -1 =-2,而我们需要的是-1</p>

<p>为了满足上面两个条件,需要先对数字进行额外的 +1 处理,即</p>

<pre><code>(-5+1)/5 -1 = -1
</code></pre>

<p>总结成公式就是:</p>

<pre><code>id=(num-1)/(t+1)-1
</code></pre>

<h4 id="2-从当前桶或相邻的桶中寻找">2. 从当前桶或相邻的桶中寻找</h4>

<p>对于一个插入的数字num, 我们需要查看[num-t,num+t]这个范围内是否存在符合的数字,而num这个桶对应的范围只是上面这个范围的一部分,上一个桶/下一个桶中有一部分和这个范围重合,也需要查看.例如</p>

<p>t=4, num=3,那么我们需要查看的范围是[-1,7],对应[-5,-1],[0,4],[5-9]这三个桶.</p>

<h4 id="3-只维护当前k个数字">3. 只维护当前k个数字</h4>

<blockquote>
<p>并且 i 和 j 之间的差的绝对值最大为 ķ</p>
</blockquote>

<p>这个约束指明: 即使在当前桶或相邻桶中找到了间隔小于等于t的数字,还不够,他们的下标的间隔还不能大于k, 显然我们的桶中无法记录下标信息(其实可以,但是那样代价太大,也不够优). 换个思路想,如果我们的桶中只记录nums[j-k,j]的数字,不就满足这个约束了. 因此维护一下桶,</p>

<pre><code>if (i &gt;= k) d.remove(getID(nums[i - k], w));
</code></pre>

<p>注意这里是在判断逻辑后才进行维护桶的操作,因此i==k时就需要删除,保证下一次循环的正确性.</p>

<h3 id="总结">总结</h3>

<p>这道题利用桶排序的思想做起来很流畅,但是一些细节要费点头脑去想,希望此本对你有帮助. peace and love~</p>
</div>
        <div class="post_footer">
          
        </div>
      </div>
      
      
    </div>
  </div>
  <a id="back_to_top" href="#" class="back_to_top"><span>△</span></a>
</div>
<footer class="footer">
  <div class="powered_by">
    <a href="https://zeuk.me">Designed by Zeuk,</a>
    <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
  </div>

  <div class="footer_slogan">
    <span>第二杯半价</span>
  </div>
</footer>



<script src="https://alonwang.github.io/blog/js/jquery-3.3.1.min.js"></script>
<script src="https://alonwang.github.io/blog/js/zozo.js"></script>
<script src="https://alonwang.github.io/blog/js/highlight.pack.js"></script>
<link  href="https://alonwang.github.io/blog/css/fancybox.min.css" rel="stylesheet">
<script src="https://alonwang.github.io/blog/js/fancybox.min.js"></script>

<script>hljs.initHighlightingOnLoad()</script>


  <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>






</body>
</html>
